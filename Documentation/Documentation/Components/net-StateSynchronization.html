<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta charset="utf-8" />
<!-- #TemplateBeginEditable name="doctitle" -->		<title>Unity - State Synchronization Details</title>
<!-- #TemplateEndEditable -->	</head>
	<body onload="DocLoaded();">
	</body>
</html>
<link href="../Images/docs.css" rel="StyleSheet" type="text/css" />
<body onload="DocLoaded();">
	<table border="0" cellpadding="0" cellspacing="0" class="titlebar">
		<tbody>
			<tr>
				<td class="titleleft">
					<img src="../images/top/left.png" /></td>
				<td>
					<a href="../../Documentation.html"><img src="../images/top/logo.png" /></a></td>
				<td class="titlemid">
					<table>
						<tbody>
							<tr>
								<td class="doctitle">
									State Synchronization Details</td>
								<td>
									<table align="right">
										<tbody>
											<tr>
<!-- #TemplateBeginEditable name="sections-nav" -->												<td class="Components">
													<a class="scripting-anchor" href="../Manual/index.html" title="Go to Unity manual"><img border="0" class="manual" src="../images/spacer.gif" /><span class="manual-text">Manual</span></a><span class="docs-navigation">&nbsp;&nbsp;&nbsp;&nbsp;</span></td>
												<td class="Components">
													<a class="scripting-anchor" href="../Components/index.html" title="Go to Reference"><img border="0" class="reference" src="../images/spacer.gif" /><span class="components-text">Reference</span></a><span class="docs-navigation">&nbsp;&nbsp;&nbsp;&nbsp;</span></td>
												<td class="Components">
													<a class="scripting-anchor" href="../ScriptReference/index.html" title="Go to Scripting Reference"><img border="0" class="scripting" src="../images/spacer.gif" /><span class="scripting-text">Scripting &nbsp;&nbsp;</span></a></td>
<!-- #TemplateEndEditable -->											</tr>
										</tbody>
									</table>
								</td>
							</tr>
							<tr>
								<td colspan="4">
									<table class="docpath" width="100%">
										<tbody>
											<tr>
												<td>
<!-- #TemplateBeginEditable name="path" -->													<a href="../Components/index.html">Reference Manual</a> &gt; <a href="../Components/net-StateSynchronization.html">State Synchronization Details</a> <!-- #TemplateEndEditable --></td>
												<td class="switchlink">
<!-- #TemplateBeginEditable name="switchLink" --><!--BeginSwitchLink--><!--EndSwitchLink--><!-- #TemplateEndEditable -->												</td>
											</tr>
										</tbody>
									</table>
								</td>
							</tr>
						</tbody>
					</table>
				</td>
				<td class="titleright" width="9">
					<img src="../images/top/right.png" /></td>
			</tr>
		</tbody>
	</table>
	<div class="manual">
		<div class="main">
<!-- #TemplateBeginEditable name="unofficial translation" -->
<div id="unofficial_translation"><center><table border="1" ><tr><td  bgcolor="yellow"><center>このドキュメントは有志により翻訳されたもので、オフィシャルではありません。オリジナルのページは<a href="http://unity3d.com/support/documentation/" target="_blank">こちら</a>。<br>This document is unofficially translated by users.Please see the original document <a href="http://unity3d.com/support/documentation/" target="_blank">here</a>.<br><br>翻訳に関する修正など、ご連絡は<a href="mailto:stagesp1@gmail.com">こちら</a>まで。<br>Please send e-mail to <a href="mailto:stagesp1@gmail.com">here</a>, when you have any question about the translation.</center></td>
<td><a href="https://github.com/shinobushiva/unity3ddocsj"><img src="../Images/pencil.png"/></a><br/>編集 (GitHub)</td>
</tr></table></center></div>
<!-- #TemplateEndEditable -->

<!-- #TemplateBeginEditable name="navigation" -->			<div class="nav">
				<div class="nav-prev">
					<a href="../Components/net-RPCDetails.html"> </a>
					<div class="nav-left">
						&nbsp;</div>
					<div class="nav-main">
						<a href="../Components/net-RPCDetails.html">Previous</a></div>
					<div class="nav-right">
						&nbsp;</div>
				</div>
				<div class="nav-next">
					<a href="../Components/net-NetworkInstantiate.html"> </a>
					<div class="nav-left">
						&nbsp;</div>
					<div class="nav-main">
						<a href="../Components/net-NetworkInstantiate.html">Next</a></div>
					<div class="nav-right">
						&nbsp;</div>
				</div>
			</div>
<!-- #TemplateEndEditable --><!-- #TemplateBeginEditable name="title" -->			<h1>
				状態の同期の詳細</h1>
<!-- #TemplateEndEditable --><!-- #TemplateBeginEditable name="body" -->			<p>
				あなたはドロップダウンの状態の同期から<span class="doc-prop">Reliable Delta Compressed</span>か<span class="doc-prop">Unreliable</span>を選択することにより、ネットワークビューごとの状態の同期を有効にすることができます。その後、観測されたプロパティがどの種類のデータと同期するのかを選択する必要があります。</p>
			<p class="vspace">
				Unityは、いくつかの特定のクラスをパック、アンパックすることができます。（Transform, Animation, RigidbodyやMonoBehaviourなど）</p>
			<p class="vspace">
				<a href="../Components/class-Transform.html">Transforms</a>は、位置、回転およびスケールを格納することによりシリアライズされます。Parentingの情報はネットワーク上で転送されません。</p>
			<p class="vspace">
				<a href="../Components/class-Animation.html">Animation</a>は、時間、重量、速度、有効になっている実行中の各アニメーションの状態をシリアライズされます。</p>
			<p class="vspace">
				<a href="../Components/class-Rigidbody.html">Rigidbody</a>は、位置、回転、速度と角速度をシリアライズします。</p>
			<p class="vspace">
				スクリプト(MonoBehaviours)は、関数の<a class="urllink" href="../ScriptReference/Network.OnSerializeNetworkView.html" rel="nofollow">OnSerializeNetworkView()</a>を呼び出します。</p>
			<div class="vspace">
				&nbsp;</div>
			<h2>
				信頼性と帯域幅</h2>
			<p>
				ネットワークビューは現在、信頼性の２つのタイプをサポートしています。Reliable Delta CompressedとUnreliableです。</p>
			<p class="vspace">
				どちらも長所と短所があり、どちらを選ぶかは状況によって選択すべきです。</p>
			<p class="vspace">
				帯域幅を最小限に抑えるための方法については<a href="../Components/net-MinimizingBandwidth.html">帯域幅の最小化</a>のページをご覧ください。</p>
			<div class="vspace">
				&nbsp;</div>
			<h3>
				Reliable Delta Compressed</h3>
			<p>
				<span class="doc-prop">Reliable Delta Compressed</span>モードは、自動的に最後に受信されたクライアントのデータを比較します。もし比べられたデータに変更が加えられていない場合、データの送信は行いません。しかし、それはデータ上のプロパティ当たりに基づいて比較されます。例えば、あなたの位置が変更されても回転が行われていない場合です。その場合、位置情報のみをネットワークを介し、送信される必要があります。.</p>
			<p class="vspace">
				このモードでは、Unityは実際にデータ変更されたかの比較のため、前のデータを各プロパティに１ビット格納します。もし変更が無ければ、プロパティに送られるデータが最小になることにより、多くの帯域幅うぃ節約することができます。</p>
			<p class="vspace">
				Unity will also ensure that every packet that is sent will arrive by resending the packet in the case of UDP packet drop until it is received. This means that if a packet is dropped, any packets sent later will not be applied until the dropped packet is re-sent and received. それまでは、それ以降のすべてのパケットはバッファに待機します。</p>
			<div class="vspace">
				&nbsp;</div>
			<h3>
				Unreliable</h3>
			<p>
				<span class="doc-prop">Unreliable</span>モードは、変更の有無に係らず、現在の状況をUnityへ送信します。送信されたデータが受信機に到達する際、それが不明であるためdelta compressedされません。</p>
			<div class="vspace">
				&nbsp;</div>
			<h2>
				使用法の決定</h2>
			<p>
				The Network layer uses UDP which is an unreliable unordered protocol but it can send reliable ordered packets, just like TCP does. It internally uses ACKs and NACKs do control packet transmission, ensuring no packets are dropped. The downside to using reliable ordered packets is that if a packet is dropped or delayed, everything stops until that packet has arrived safely. This can cause noticeable delays in transmission in lag intensive networks.</p>
			<p class="vspace">
				Unreliable sending is useful for data where you know that it is going to change every frame anyway. For example, in a racing game, you can practically rely on that the player&#39;s car is always moving. Thus delta compression and reliable transfer only adds overhead without adding an practical gain.</p>
			<p class="vspace">
				In general, you should use Unreliable sending when you know data is changing all the time and minimizing lag is critical. If the data tracked by the Network View is not changing every frame and bandwidth is important to you, then delta compressed is preferred.</p>
			<p class="vspace">
				It is important to understand that lag is not the same thing as bandwidth. They are two separate properties that you want to optimize for in different use case.</p>
			<div class="vspace">
				&nbsp;</div>
			<h2>
				Prediction</h2>
			<p>
				When the server has <a href="../Components/net-HighLevelOverview.html">full authority</a> over the world state, the clients only update the game according to these states they receive from the server. One problem which arises is that controls feel unnatural as when a player pushes the forward button for example, he won&#39;t move until the updated state is received from the server. This delay depends on the latency of the connection so the worse the connection the more unnatural the actions of the player become.</p>
			<p class="vspace">
				One way to help with this is <span class="doc-keyword">Player Prediction</span> which means the client, knowing how the server calculates his movement, predicts the movement himself. So the player moves instantly with the control but the server sees his position from his last update. When the state update arrives from the server, the client will compare what he predicted with what actually happened. This might differ as the server might know more about the environment around the player, the client just knows what he needs to know. Errors in prediction are corrected as they happen, if they are corrected gradually the correction will look more smooth and less noticeable.</p>
			<div class="vspace">
				&nbsp;</div>
			<h2>
				Dead reckoning or interpolation/extrapolation</h2>
			<p>
				It is possible to apply the same principle with player prediction to the opponents of the player. <span class="doc-keyword">Extrapolation</span> is when several last (buffered) known position, velocity and direction of an opponent is used to predict where he will be in the next frames. When the next state update finally arrives with the correct position, the client state will be updated with accurate information, possibly skipping if the prediction was bad. In FPS games the behavior of players can be very erratic so this kind of prediction only has limited effect. If the lag gets high enough the opponent will skip badly as the errors in prediction get larger.</p>
			<p class="vspace">
				<span class="doc-keyword">Interpolation</span> is when packets get dropped on the way to the client and the opponent position would normally pause and then jump to the newest position when a new packet finally arrives. By delaying the world state by some set amount of time (like 100 ms) and then interpolating the last known position with the new one, the movement between these two points, where packets were dropped, will be smooth.</p>
			<p>
				&nbsp;</p>
			<small>Page last updated: 2010-07-19</small>
			<p>
				&nbsp;</p>
<script type="text/javascript">


    var allHTMLTags = new Array();
    document.divs = new Array();

    function getElementByClass(theClass) {

	    var allHTMLTags=document.getElementsByTagName("*");

	    for (var i=0; i<allHTMLTags.length; i++) {

		    if (allHTMLTags[i].className==theClass) {
			    return true;
		    }
	    }
	    return false;
    }

    function ShowHideDiv(containerName, className, content){
	var container = document.getElementById(containerName);
	if(container == null)
		return;
	if(content == '') {//In case there are no divs in the page we still can change the icons.
		if(containerName == 'desktopRef') {
			if(container.innerHTML == "<img src="../Images/DesktopNO.png" alt="">") {
				container.innerHTML = "<img src="../Images/DesktopYES.png" alt="">";
				SetCookie(containerName, 'set', 30);
			} else {
				container.innerHTML = "<img src="../Images/DesktopNO.png" alt="">";
				UnSetCookie(containerName);
			}
		}
		if(containerName == 'iosRef') {
			if(container.innerHTML == "<img src="../Images/iPhoneNO.png" alt="">") {
				container.innerHTML = "<img src="../Images/iPhoneYES.png" alt="">";
				SetCookie(containerName, 'set', 30);
			} else {
				container.innerHTML = "<img src="../Images/iPhoneNO.png" alt="">";
				UnSetCookie(containerName);
			}
		}
		if(containerName == 'androidRef') {
			if(container.innerHTML == "<img src="../Images/AndroidNO.png" alt="">") {
				container.innerHTML = "<img src="../Images/AndroidYES.png" alt="">";
				SetCookie(containerName, 'set', 30);
			} else {
				container.innerHTML = "<img src="../Images/AndroidNO.png" alt="">";
				UnSetCookie(containerName);
			}	
		}
	} else {
		if(container.innerHTML == "<h1><img src="../Images/PlatformArrowRight.png" alt=""> " + content + "</h1>") {
		container.innerHTML = "<h1><img src="../Images/PlatformArrowDown.png" alt="">" + content + "</h1>";
			SetCookie(containerName, 'set', 30);
		} else {
			container.innerHTML = "<h1><img src="../Images/PlatformArrowRight.png" alt="">" + content + "</h1>";
			UnSetCookie(containerName);
		}
	}
	for(var i = 0; i < document.divs.length; i++) {
		var divClassName = document.divs[i];
		var matched = false;
		if(divClassName.className == className)
			   matched = true;
		if(matched) {
			
			if(divClassName != null) {
				if (divClassName.style.display == 'block') {
					divClassName.style.display = 'none';
					if(content == '') {
						if(className == 'specific-desktop')
							container.innerHTML = "<img src="../Images/DesktopNO.png" alt="" />";
						if(className == 'specific-ios')
							container.innerHTML = "<img src="../Images/iPhoneNO.png" alt="" />";
						if(className == 'specific-android')
							container.innerHTML = "<img src="../Images/AndroidNO.png" alt="" />";
					} else {
						container.innerHTML = "<h1><img src="../Images/PlatformArrowRight.png" alt="" /> " + content + "</h1>";
					}
					UnSetCookie(containerName);
				} else {
					divClassName.style.display = 'block';
					if(content == '') {
						if(className == 'specific-desktop')
							container.innerHTML = "<img src="../Images/DesktopYES.png" alt="" />";
						if(className == 'specific-ios')
							container.innerHTML = "<img src="../Images/iPhoneYES.png" alt="" />";
						if(className == 'specific-android')
							container.innerHTML = "<img src="../Images/AndroidYES.png" alt="" />";
					} else {
						container.innerHTML = "<h1><img src="../Images/PlatformArrowDown.png" alt="" /> " + content + "</h1>";
					}
					SetCookie(containerName, 'set', 30);
				}
			}
		}	
        }			   
    }
    function UnSetCookie(cn) {
    	SetCookie(cn,'',30);
    }

    function GetCookie(cName) {
	if (document.cookie.length > 0) {
            cStart = document.cookie.indexOf(cName + "=");
	    if(cStart != -1) {
	        cStart = cStart + cName.length + 1;
	        cEnd = document.cookie.indexOf(";", cStart);
	        if (cEnd == -1) {
	            cEnd = document.cookie.length;
	        }
	        return unescape(document.cookie.substring(cStart, cEnd));;
	    }
	}
	return "";
    }

    function SetCookie(cName, value, expireDays) {
	var exDate = new Date();
	exDate.setDate(exDate.getDate()+expireDays);
	document.cookie = cName + "=" + escape(value) + ((expireDays ==null) ? "" : ";expires=" + exDate.toGMTString()) + ";path=/";
    }

    function DocLoaded() {
	document.divs = document.getElementsByTagName('div');
	var prefDesktop = GetCookie('desktopRef');
	var prefiOS = GetCookie('iosRef');
	var prefAndroid = GetCookie('androidRef');
	var firstTime = GetCookie('FT');
	if (firstTime == null || firstTime == "" ) {
	    SetCookie('FT', 'no', 30);
	    SetCookie('desktopRef', 'set', 30)
	} else if (prefDesktop == null || prefDesktop =="") {
	    if(getElementByClass('desktopRefIMG')) {
	        ShowHideDiv('desktopRef','specific-desktop','');
	    } else {
	        ShowHideDiv('desktopRef','specific-desktop','Desktop');
	    }
	}
	if (prefiOS == null || prefiOS =="") {
	    if(getElementByClass('iosRefIMG')) {
	        ShowHideDiv('iosRef','specific-ios','');
	    } else {
	        ShowHideDiv('iosRef','specific-ios','iOS');
	    }
	}
	if (prefAndroid == null || prefAndroid =="") {
	    if(getElementByClass('androidRefIMG')) {
	        ShowHideDiv('androidRef','specific-android','');
	    } else {
	        ShowHideDiv('androidRef','specific-android','Android');
	    }
	}	
    }
    </script><!-- #TemplateEndEditable -->			<div class="nav">
				<div class="nav-prev">
					<small><a href="../Components/net-RPCDetails.html"> </a></small>
					<div class="nav-left">
						&nbsp;</div>
					<div class="nav-main">
						<small><a href="../Components/net-RPCDetails.html">Previous</a></small></div>
					<div class="nav-right">
						&nbsp;</div>
				</div>
				<div class="nav-next">
					<small><a href="../Components/net-NetworkInstantiate.html"> </a></small>
					<div class="nav-left">
						&nbsp;</div>
					<div class="nav-main">
						<small><a href="../Components/net-NetworkInstantiate.html">Next</a></small></div>
					<div class="nav-right">
						&nbsp;</div>
				</div>
			</div>
		</div>
	</div>
</body>
